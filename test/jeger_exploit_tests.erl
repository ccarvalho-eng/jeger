-module(jeger_exploit_tests).

-include_lib("eunit/include/eunit.hrl").

execute_command_invalid_node_test_() ->
    {timeout, 60, fun() ->
        Result = jeger_exploit:execute_command("192.168.255.255", "fake", test, "1+1"),
        ?assertEqual({error, connection_failed}, Result)
    end}.

read_file_invalid_node_test_() ->
    {timeout, 60, fun() ->
        Result = jeger_exploit:read_file("192.168.255.255", "fake", test, "/etc/passwd"),
        ?assertEqual({error, connection_failed}, Result)
    end}.

list_directory_invalid_node_test_() ->
    {timeout, 60, fun() ->
        Result = jeger_exploit:list_directory("192.168.255.255", "fake", test, "/tmp"),
        ?assertEqual({error, connection_failed}, Result)
    end}.

spawn_shell_invalid_node_test_() ->
    {timeout, 60, fun() ->
        Result = jeger_exploit:spawn_shell("192.168.255.255", "fake", test),
        ?assertEqual({error, connection_failed}, Result)
    end}.
